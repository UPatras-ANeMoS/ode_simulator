
matrix([(cos(phi)*cos(psi)*sin(theta)+sin(phi)*sin(psi))*U1-(sin(phi)*cos(psi)*sin(theta)-cos(phi)*sin(psi))*(cos(q1)*(m2*cos(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*sin(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta)))-sin(q1)*(-m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))))-(cos(phi)*cos(psi)*sin(theta)+sin(phi)*sin(psi))*(cos(q1)*(-m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta)))+sin(q1)*(m2*cos(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*sin(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))))-cos(psi)*cos(theta)*(m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta)))],[(cos(phi)*sin(psi)*sin(theta)-sin(phi)*cos(psi))*U1-(sin(phi)*sin(psi)*sin(theta)+cos(phi)*cos(psi))*(cos(q1)*(m2*cos(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*sin(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta)))-sin(q1)*(-m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))))-(cos(phi)*sin(psi)*sin(theta)-sin(phi)*cos(psi))*(cos(q1)*(-m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta)))+sin(q1)*(m2*cos(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*sin(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))))-sin(psi)*cos(theta)*(m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta)))],[cos(phi)*cos(theta)*U1-sin(phi)*cos(theta)*(cos(q1)*(m2*cos(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*sin(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta)))-sin(q1)*(-m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))))-cos(phi)*cos(theta)*(cos(q1)*(-m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta)))+sin(q1)*(m2*cos(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+m2*sin(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))))+sin(theta)*(m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta)))-g*m],[la*U2+l1*m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+lcy2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-l1*m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(lcx2+l2)*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+lcy1*m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-Ixz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-Iyz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1))-(lcx1+l1)*m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-(sin(q1)*wz+cos(q1)*wy)*(Ixy1*(sin(q1)*wz+cos(q1)*wy)+Iyy1*(cos(q1)*wz-sin(q1)*wy)+Iyz1*(wx+qd1))+(cos(q1)*wz-sin(q1)*wy)*(Ixx1*(sin(q1)*wz+cos(q1)*wy)+Ixy1*(cos(q1)*wz-sin(q1)*wy)+Ixz1*(wx+qd1))-Iyz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-Ixz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+(Iy-Iz)*wy*wz],[la*U3-cos(q1)*(sin(q2)*(lcz2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-l1*m2*cos(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-(lcx2+l2)*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Iyy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))+(wx+qd2+qd1)*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1)))+cos(q2)*(-lcz2*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+l1*m2*sin(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+lcy2*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixx2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Ixy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))-(wx+qd2+qd1)*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1)))+lcy1*m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-lcz1*m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+(cos(q1)*wz-sin(q1)*wy)*(Ixz1*(sin(q1)*wz+cos(q1)*wy)+Iyz1*(cos(q1)*wz-sin(q1)*wy)+Izz1*(wx+qd1))-(wx+qd1)*(Ixy1*(sin(q1)*wz+cos(q1)*wy)+Iyy1*(cos(q1)*wz-sin(q1)*wy)+Iyz1*(wx+qd1))+Ixy1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+Ixx1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy))+sin(q1)*(cos(q2)*(lcz2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-l1*m2*cos(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-(lcx2+l2)*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Iyy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))+(wx+qd2+qd1)*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1)))-sin(q2)*(-lcz2*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+l1*m2*sin(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+lcy2*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixx2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Ixy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))-(wx+qd2+qd1)*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1)))+lcz1*m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-(lcx1+l1)*m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-(sin(q1)*wz+cos(q1)*wy)*(Ixz1*(sin(q1)*wz+cos(q1)*wy)+Iyz1*(cos(q1)*wz-sin(q1)*wy)+Izz1*(wx+qd1))+(wx+qd1)*(Ixx1*(sin(q1)*wz+cos(q1)*wy)+Ixy1*(cos(q1)*wz-sin(q1)*wy)+Ixz1*(wx+qd1))+Iyy1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+Ixy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(Iz-Ix)*wx*wz],[U4-sin(q1)*(sin(q2)*(lcz2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-l1*m2*cos(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-(lcx2+l2)*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Iyy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))+(wx+qd2+qd1)*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1)))+cos(q2)*(-lcz2*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+l1*m2*sin(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+lcy2*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixx2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Ixy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))-(wx+qd2+qd1)*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1)))+lcy1*m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-lcz1*m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+(cos(q1)*wz-sin(q1)*wy)*(Ixz1*(sin(q1)*wz+cos(q1)*wy)+Iyz1*(cos(q1)*wz-sin(q1)*wy)+Izz1*(wx+qd1))-(wx+qd1)*(Ixy1*(sin(q1)*wz+cos(q1)*wy)+Iyy1*(cos(q1)*wz-sin(q1)*wy)+Iyz1*(wx+qd1))+Ixy1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+Ixx1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy))-cos(q1)*(cos(q2)*(lcz2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-l1*m2*cos(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-(lcx2+l2)*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Iyy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))+(wx+qd2+qd1)*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1)))-sin(q2)*(-lcz2*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+l1*m2*sin(q2)*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+lcy2*m2*(lcy2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-lcx2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-l2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))+(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))+l2*(wx+qd2+qd1)*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))+Ixx2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+Ixy2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Izz2*(wx+qd2+qd1))-(wx+qd2+qd1)*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1)))+lcz1*m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-(lcx1+l1)*m1*((sin(q1)*wz+cos(q1)*wy)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))-(cos(q1)*wz-sin(q1)*wy)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcx1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+lcy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(wx+qd1)*(sin(q1)*wz+cos(q1)*wy)-g*sin(theta))-(sin(q1)*wz+cos(q1)*wy)*(Ixz1*(sin(q1)*wz+cos(q1)*wy)+Iyz1*(cos(q1)*wz-sin(q1)*wy)+Izz1*(wx+qd1))+(wx+qd1)*(Ixx1*(sin(q1)*wz+cos(q1)*wy)+Ixy1*(cos(q1)*wz-sin(q1)*wy)+Ixz1*(wx+qd1))+Iyy1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+Ixy1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(Ix-Iy)*wx*wy],[l1*m2*sin(q2)*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)+lcy2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-l1*m2*cos(q2)*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(lcx2+l2)*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+lcy1*m1*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-(wx+qd1)*(lcx1*(wx+qd1)-lcz1*(sin(q1)*wz+cos(q1)*wy))+(cos(q1)*wz-sin(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+lcz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-Ixz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-Iyz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1))-(lcx1+l1)*m1*(-(sin(q1)*wz+cos(q1)*wy)*(lcy1*(sin(q1)*wz+cos(q1)*wy)-lcx1*(cos(q1)*wz-sin(q1)*wy))+(wx+qd1)*(lcz1*(cos(q1)*wz-sin(q1)*wy)-lcy1*(wx+qd1))-lcz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-(sin(q1)*wz+cos(q1)*wy)*(Ixy1*(sin(q1)*wz+cos(q1)*wy)+Iyy1*(cos(q1)*wz-sin(q1)*wy)+Iyz1*(wx+qd1))+(cos(q1)*wz-sin(q1)*wy)*(Ixx1*(sin(q1)*wz+cos(q1)*wy)+Ixy1*(cos(q1)*wz-sin(q1)*wy)+Ixz1*(wx+qd1))-Iyz1*(-sin(q1)*qd1*wz-cos(q1)*qd1*wy)-Ixz1*(cos(q1)*qd1*wz-sin(q1)*qd1*wy)+tau1],[lcy2*m2*(-l2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))^2+cos(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))+lcz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-(wx+qd2+qd1)*(lcx2*(wx+qd2+qd1)-lcz2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy)))-sin(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))-l2*(wx+qd2+qd1)^2)-(lcx2+l2)*m2*(sin(q2)*(-l1*(cos(q1)*wz-sin(q1)*wy)^2-l1*(wx+qd1)^2+g*cos(phi)*sin(q1)*cos(theta)+g*sin(phi)*cos(q1)*cos(theta))-lcz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))+(wx+qd2+qd1)*(lcz2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))-lcy2*(wx+qd2+qd1))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(lcy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))-lcx2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))+cos(q2)*(l1*(cos(q1)*wz-sin(q1)*wy)*(sin(q1)*wz+cos(q1)*wy)-g*sin(phi)*sin(q1)*cos(theta)+g*cos(phi)*cos(q1)*cos(theta))+l2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy)))-Ixz2*(cos(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy)-sin(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy))-Iyz2*(cos(q2)*(-qd2*(sin(q1)*wz+cos(q1)*wy)-sin(q1)*qd1*wz-cos(q1)*qd1*wy)+sin(q2)*(qd2*(cos(q1)*wz-sin(q1)*wy)+cos(q1)*qd1*wz-sin(q1)*qd1*wy))-(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))*(Iyy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixy2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Iyz2*(wx+qd2+qd1))+(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))*(Ixy2*(sin(q2)*(sin(q1)*wz+cos(q1)*wy)+cos(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixx2*(cos(q2)*(sin(q1)*wz+cos(q1)*wy)-sin(q2)*(cos(q1)*wz-sin(q1)*wy))+Ixz2*(wx+qd2+qd1))+tau2]);
