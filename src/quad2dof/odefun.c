#include "odefun.h"
#include <math.h>
#include "MatrixLite.h"

void odefun(const double X[16] , double dX[16], double U[6] , double t)
{
    double tau2 = U[5];
    double tau1 = U[4];
    double U4 = U[3];
    double U3 = U[2];
    double U2 = U[1];
    double q2d = X[15];
    double q1d = X[13];
    double wx = X[7];
    double wy = X[9];
    double wz = X[11];
    double U1 = U[0];
    double theta = X[8];
    double q2 = X[14];
    double q1 = X[12];
    double psi = X[10];
    double phi = X[6];
    double c_phi = cos(phi);
    double c_psi = cos(psi);
    double s_q1 = sin(q1);
    double s_phi = sin(phi);
    double c_q1 = cos(q1);
    double s_q2 = sin(q2);
    double c_q2 = cos(q2);
    double s_theta = sin(theta);
    double s_psi = sin(psi);
    double c_theta = cos(theta);
    double D[8][8] = {
    {6./5., 0., 0., ((-(((c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*s_q2 + (s_phi*c_psi*s_q1 - c_phi*c_psi*c_q1)*c_q2 + 3.*s_phi*c_psi*s_q1 - 3.*c_phi*c_psi*c_q1)*s_theta + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*s_q2 + ((-cos(phi))*s_psi*s_q1 - s_phi*s_psi*c_q1)*c_q2 - 3.*c_phi*s_psi*s_q1 - 3.*s_phi*s_psi*c_q1)))/200., (c_psi*c_q1*s_q2 + c_psi*s_q1*c_q2 + 3.*c_psi*s_q1)*c_theta/200., (c_psi*s_q1*s_q2 - c_psi*c_q1*c_q2 - 3.*c_psi*c_q1)*c_theta/200., ((-(((c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*s_q2 + (s_phi*c_psi*s_q1 - c_phi*c_psi*c_q1)*c_q2 + 3.*s_phi*c_psi*s_q1 - 3.*c_phi*c_psi*c_q1)*s_theta + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*s_q2 + ((-cos(phi))*s_psi*s_q1 - s_phi*s_psi*c_q1)*c_q2 - 3.*c_phi*s_psi*s_q1 - 3.*s_phi*s_psi*c_q1)))/200., ((-(((c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*s_q2 + (s_phi*c_psi*s_q1 - c_phi*c_psi*c_q1)*c_q2)*s_theta + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*s_q2 + ((-cos(phi))*s_psi*s_q1 - s_phi*s_psi*c_q1)*c_q2)))/200.},
    {0., 6./5., 0., ((-(((c_phi*s_psi*s_q1 + s_phi*s_psi*c_q1)*s_q2 + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*c_q2 + 3.*s_phi*s_psi*s_q1 - 3.*c_phi*s_psi*c_q1)*s_theta + (c_phi*c_psi*c_q1 - s_phi*c_psi*s_q1)*s_q2 + (c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*c_q2 + 3.*c_phi*c_psi*s_q1 + 3.*s_phi*c_psi*c_q1)))/200., (s_psi*c_q1*s_q2 + s_psi*s_q1*c_q2 + 3.*s_psi*s_q1)*c_theta/200., (s_psi*s_q1*s_q2 - s_psi*c_q1*c_q2 - 3.*s_psi*c_q1)*c_theta/200., ((-(((c_phi*s_psi*s_q1 + s_phi*s_psi*c_q1)*s_q2 + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*c_q2 + 3.*s_phi*s_psi*s_q1 - 3.*c_phi*s_psi*c_q1)*s_theta + (c_phi*c_psi*c_q1 - s_phi*c_psi*s_q1)*s_q2 + (c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*c_q2 + 3.*c_phi*c_psi*s_q1 + 3.*s_phi*c_psi*c_q1)))/200., ((-(((c_phi*s_psi*s_q1 + s_phi*s_psi*c_q1)*s_q2 + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*c_q2)*s_theta + (c_phi*c_psi*c_q1 - s_phi*c_psi*s_q1)*s_q2 + (c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*c_q2)))/200.},
    {0., 0., 6./5., ((-((c_phi*s_q1 + s_phi*c_q1)*s_q2 + (s_phi*s_q1 - c_phi*c_q1)*c_q2 + 3.*s_phi*s_q1 - 3.*c_phi*c_q1)))*c_theta/200., ((-(c_q1*s_q2 + s_q1*c_q2 + 3.*s_q1)))*s_theta/200., ((-(s_q1*s_q2 - c_q1*c_q2 - 3.*c_q1)))*s_theta/200., ((-((c_phi*s_q1 + s_phi*c_q1)*s_q2 + (s_phi*s_q1 - c_phi*c_q1)*c_q2 + 3.*s_phi*s_q1 - 3.*c_phi*c_q1)))*c_theta/200., ((-((c_phi*s_q1 + s_phi*c_q1)*s_q2 + (s_phi*s_q1 - c_phi*c_q1)*c_q2)))*c_theta/200.},
    {((-(((125.*c_phi*c_psi*s_q1 + 125.*s_phi*c_psi*c_q1)*s_q2 + (125.*s_phi*c_psi*s_q1 - 125.*c_phi*c_psi*c_q1)*c_q2 + 375.*s_phi*c_psi*s_q1 - 375.*c_phi*c_psi*c_q1 - s_phi*c_psi)*s_theta + (125.*s_phi*s_psi*s_q1 - 125.*c_phi*s_psi*c_q1)*s_q2 + ((-125.)*c_phi*s_psi*s_q1 - 125.*s_phi*s_psi*c_q1)*c_q2 - 375.*c_phi*s_psi*s_q1 - 375.*s_phi*s_psi*c_q1 + c_phi*s_psi)))/25000., ((-(((125.*c_phi*s_psi*s_q1 + 125.*s_phi*s_psi*c_q1)*s_q2 + (125.*s_phi*s_psi*s_q1 - 125.*c_phi*s_psi*c_q1)*c_q2 + 375.*s_phi*s_psi*s_q1 - 375.*c_phi*s_psi*c_q1 - s_phi*s_psi)*s_theta + (125.*c_phi*c_psi*c_q1 - 125.*s_phi*c_psi*s_q1)*s_q2 + (125.*c_phi*c_psi*s_q1 + 125.*s_phi*c_psi*c_q1)*c_q2 + 375.*c_phi*c_psi*s_q1 + 375.*s_phi*c_psi*c_q1 - c_phi*c_psi)))/25000., ((-((125.*c_phi*s_q1 + 125.*s_phi*c_q1)*s_q2 + (125.*s_phi*s_q1 - 125.*c_phi*c_q1)*c_q2 + 375.*s_phi*s_q1 - 375.*c_phi*c_q1 - sin(phi))))*c_theta/25000., 0.01 - (500.*c_q1*s_q2 + (500.*s_q1 - 500000.)*c_q2 + 1500.*s_q1 - 833333.)/5e+08, 0., 0., ((-(500.*c_q1*s_q2 + (500.*s_q1 - 500000.)*c_q2 + 1500.*s_q1 - 833333.)))/5e+08, ((-(1000.*c_q1*s_q2 + (1000.*s_q1 - 500000.)*c_q2 - 333333.)))/1e+09},
    {(125.*c_psi*c_q1*s_q2 + 125.*c_psi*s_q1*c_q2 + 375.*c_psi*s_q1 - cos(psi))*c_theta/25000., (125.*s_psi*c_q1*s_q2 + 125.*s_psi*s_q1*c_q2 + 375.*s_psi*s_q1 - sin(psi))*c_theta/25000., ((-(125.*c_q1*s_q2 + 125.*s_q1*c_q2 + 375.*s_q1 - 1.)))*s_theta/25000., 0., 0.01 - ((666666.*pow(s_q1, 2.) - 333333.)*pow(s_q2, 2.) + ((-666666.)*c_q1*s_q1*c_q2 - 1e+06*c_q1*s_q1 + 1000.*c_q1)*s_q2 + (1000.*s_q1 - 1e+06*pow(s_q1, 2.))*c_q2 - 1.66667e+06*pow(s_q1, 2.) + 3000.*s_q1)/1e+09, (((666666.*pow(s_q1, 2.) - 333333.)*c_q2 + 1e+06*pow(s_q1, 2.) - 1000.*s_q1 - 500000.)*s_q2 - 666666.*c_q1*s_q1*pow(c_q2, 2.) + (1000.*c_q1 - 1e+06*c_q1*s_q1)*c_q2 - 1e+06*c_q1*s_q1 + 3000.*c_q1)/1e+09, 0., 0.},
    {(c_psi*s_q1*s_q2 - c_psi*c_q1*c_q2 - 3.*c_psi*c_q1)*c_theta/200., (s_psi*s_q1*s_q2 - s_psi*c_q1*c_q2 - 3.*s_psi*c_q1)*c_theta/200., ((-(s_q1*s_q2 - c_q1*c_q2 - 3.*c_q1)))*s_theta/200., 0., ((-(((666666.*pow(c_q1, 2.) - 333333.)*c_q2 + 1e+06*pow(c_q1, 2.) - 500000.)*s_q2 + 666666.*c_q1*s_q1*pow(c_q2, 2.) + 1e+06*c_q1*s_q1*c_q2 + 1e+06*c_q1*s_q1)))/1e+09, 0.02 - ((666666.*pow(c_q1, 2.) - 333333.)*pow(s_q2, 2.) + (666666.*c_q1*s_q1*c_q2 + 1e+06*c_q1*s_q1)*s_q2 - 1e+06*pow(c_q1, 2.)*c_q2 - 1.66667e+06*pow(c_q1, 2.))/1e+09, 0., 0.},
    {((-(((c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*s_q2 + (s_phi*c_psi*s_q1 - c_phi*c_psi*c_q1)*c_q2 + 3.*s_phi*c_psi*s_q1 - 3.*c_phi*c_psi*c_q1)*s_theta + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*s_q2 + ((-cos(phi))*s_psi*s_q1 - s_phi*s_psi*c_q1)*c_q2 - 3.*c_phi*s_psi*s_q1 - 3.*s_phi*s_psi*c_q1)))/200., ((-(((c_phi*s_psi*s_q1 + s_phi*s_psi*c_q1)*s_q2 + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*c_q2 + 3.*s_phi*s_psi*s_q1 - 3.*c_phi*s_psi*c_q1)*s_theta + (c_phi*c_psi*c_q1 - s_phi*c_psi*s_q1)*s_q2 + (c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*c_q2 + 3.*c_phi*c_psi*s_q1 + 3.*s_phi*c_psi*c_q1)))/200., ((-((c_phi*s_q1 + s_phi*c_q1)*s_q2 + (s_phi*s_q1 - c_phi*c_q1)*c_q2 + 3.*s_phi*s_q1 - 3.*c_phi*c_q1)))*c_theta/200., (500000.*c_q2 + 833333.)/5e+08, 0., 0., (500000.*c_q2 + 833333.)/5e+08, (500000.*c_q2 + 333333.)/1e+09},
    {((-(((c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*s_q2 + (s_phi*c_psi*s_q1 - c_phi*c_psi*c_q1)*c_q2)*s_theta + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*s_q2 + ((-cos(phi))*s_psi*s_q1 - s_phi*s_psi*c_q1)*c_q2)))/200., ((-(((c_phi*s_psi*s_q1 + s_phi*s_psi*c_q1)*s_q2 + (s_phi*s_psi*s_q1 - c_phi*s_psi*c_q1)*c_q2)*s_theta + (c_phi*c_psi*c_q1 - s_phi*c_psi*s_q1)*s_q2 + (c_phi*c_psi*s_q1 + s_phi*c_psi*c_q1)*c_q2)))/200., ((-((c_phi*s_q1 + s_phi*c_q1)*s_q2 + (s_phi*s_q1 - c_phi*c_q1)*c_q2)))*c_theta/200., (500000.*c_q2 + 333333.)/1e+09, 0., 0., (500000.*c_q2 + 333333.)/1e+09, 333333./1e+09}
};
    double W[8][1] = {
    {(c_phi*c_psi*s_theta + s_phi*s_psi)*U1 - (s_phi*c_psi*s_theta - c_phi*s_psi)*(c_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)))) - s_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta))) - (c_phi*c_psi*s_theta + s_phi*s_psi)*(c_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta)) + s_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))))) - c_psi*c_theta*(0.1*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 0.1*((-0.05)*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.05*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta))},
    {(c_phi*s_psi*s_theta - s_phi*c_psi)*U1 - (s_phi*s_psi*s_theta + c_phi*c_psi)*(c_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)))) - s_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta))) - (c_phi*s_psi*s_theta - s_phi*c_psi)*(c_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta)) + s_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))))) - s_psi*c_theta*(0.1*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 0.1*((-0.05)*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.05*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta))},
    {c_phi*c_theta*U1 - s_phi*c_theta*(c_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)))) - s_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta))) - c_phi*c_theta*(c_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta)) + s_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))))) + s_theta*(0.1*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 0.1*((-0.05)*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.05*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta)) - 9.81},
    {0.2*U2 - 0.01*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) - 0.0002*(c_q1*(0.1*c_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*((-0.05)*pow(c_q1*wz - s_q1*wy, 2.) - 0.05*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) - 0.1*s_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)))) - s_q1*(0.1*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) + 0.1*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) + 0.1*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta))) - 0.01*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) - 0.005*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) - 0.005*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 8.3333e-05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)) - 8.3333e-05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 0.01*wy*wz},
    {0.2*U3 - c_q1*((-sin(q2))*((-0.01)*c_q2*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) - 0.005*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 8.3333e-05*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) - 8.3333e-05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))) - 0.01*c_q2*s_q2*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta)) + s_q1*(c_q2*((-0.01)*c_q2*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) - 0.005*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 8.3333e-05*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) - 8.3333e-05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))) - 0.01*pow(s_q2, 2.)*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) - 0.005*((-0.05)*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.05*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 8.3333e-05*((-sin(q1))*q1d*wz - c_q1*q1d*wy) - 8.3333e-05*(wx + q1d)*(s_q1*wz + c_q1*wy)) + 0.0002*(0.1*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 0.1*((-0.05)*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.05*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta)) + 0.01*wx*wz},
    {U4 - s_q1*((-sin(q2))*((-0.01)*c_q2*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) - 0.005*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 8.3333e-05*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) - 8.3333e-05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))) - 0.01*c_q2*s_q2*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta)) - c_q1*(c_q2*((-0.01)*c_q2*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) - 0.005*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 8.3333e-05*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) - 8.3333e-05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))) - 0.01*pow(s_q2, 2.)*((-0.05)*(c_q2*((-q2d)*(s_q1*wz + c_q1*wy) - s_q1*q1d*wz - c_q1*q1d*wy) - s_q2*(q2d*(c_q1*wz - s_q1*wy) + c_q1*q1d*wz - s_q1*q1d*wy)) + 0.05*(wx + q2d + q1d)*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy)) - 0.1*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.1*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) - 0.005*((-0.05)*((-sin(q1))*q1d*wz - c_q1*q1d*wy) + 0.05*(wx + q1d)*(s_q1*wz + c_q1*wy) - 9.81*s_theta) + 8.3333e-05*((-sin(q1))*q1d*wz - c_q1*q1d*wy) - 8.3333e-05*(wx + q1d)*(s_q1*wz + c_q1*wy))},
    {(-0.01)*s_q2*((-0.05)*pow(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy), 2.) + c_q2*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + s_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 0.05*pow(wx + q2d + q1d, 2.)) - 0.01*c_q2*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) - 0.005*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) - 0.005*(0.05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) - 8.3333e-05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)) - 8.3333e-05*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) + tau1},
    {(-0.005)*((-sin(q2))*((-0.1)*pow(c_q1*wz - s_q1*wy, 2.) - 0.1*pow(wx + q1d, 2.) + 9.81*c_phi*s_q1*c_theta + 9.81*s_phi*c_q1*c_theta) + c_q2*(0.1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - 9.81*s_phi*s_q1*c_theta + 9.81*c_phi*c_q1*c_theta) + 0.05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy))) - 8.3333e-05*(c_q2*(s_q1*wz + c_q1*wy) + s_q2*(c_q1*wz - s_q1*wy))*(c_q2*(c_q1*wz - s_q1*wy) - s_q2*(s_q1*wz + c_q1*wy)) + tau2}
};

    mxSystemSolve((CTFloat *)D, (CTFloat *)W, 8);

    dX[0] = X[1];
    dX[1] = W[0][0];
    dX[2] = X[3];
    dX[3] = W[1][0];
    dX[4] = X[5];
    dX[5] = W[2][0];
    dX[6] = X[7];
    dX[7] = W[3][0];
    dX[8] = X[9];
    dX[9] = W[4][0];
    dX[10] = X[11];
    dX[11] = W[5][0];
    dX[12] = X[13];
    dX[13] = W[6][0];
    dX[14] = X[15];
    dX[15] = W[7][0];

}
