#include "odefun.h"
#include <math.h>
#include "MatrixLite.h"

void odefun(const double X[16] , double dX[16], double U[6] , double t)
{
    double tau2 = U[5];
    double tau1 = U[4];
    double U4 = U[3];
    double U3 = U[2];
    double U2 = U[1];
    double qd2 = X[15];
    double qd1 = X[13];
    double wx = X[7];
    double wy = X[9];
    double wz = X[11];
    double U1 = U[0];
    double theta = X[8];
    double q2 = X[14];
    double q1 = X[12];
    double psi = X[10];
    double phi = X[6];
    double Ix = 0.01;
    double Iy = 0.01;
    double Iz = 0.02;
    double m = 1.;
    double g = 9.81;
    double la = 0.2;
    double b = 9.29e-05;
    double d = 1.1e-06;
    double m1 = 0.1;
    double m2 = 0.1;
    double l1 = 0.1;
    double l2 = 0.1;
    double lcx1 = (-l1)/2.;
    double lcy1 = 0.;
    double lcz1 = 0.;
    double lcx2 = (-l1)/2.;
    double lcy2 = 0.;
    double lcz2 = 0.;
    double I1 = 1./12.*m1*pow(l1, 2.);
    double I2 = 1./12.*m2*pow(l2, 2.);
    double Ixx1 = 0.;
    double Iyy1 = I1;
    double Izz1 = I1;
    double Ixy1 = 0.;
    double Ixz1 = 0.;
    double Iyz1 = 0.;
    double Ixx2 = 0.;
    double Iyy2 = I1;
    double Izz2 = I1;
    double Ixy2 = 0.;
    double Ixz2 = 0.;
    double Iyz2 = 0.;
    double c_phi = cos(phi);
    double s_phi = sin(phi);
    double c_psi = cos(psi);
    double s_q1 = sin(q1);
    double c_q1 = cos(q1);
    double s_q2 = sin(q2);
    double c_q2 = cos(q2);
    double s_theta = sin(theta);
    double s_psi = sin(psi);
    double c_theta = cos(theta);
    double D[8][8] = {
    {m2 + m1 + m, 0., 0., ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_psi*c_q1)*s_theta + (((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*s_q1 + (lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*c_q2 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*s_phi + lcy1*m1*c_phi)*s_psi*c_q1, ((-lcz2)*m2 - lcz1*m1)*c_phi*c_psi*s_theta + ((lcy2*m2*c_psi*s_q1 + (lcx2 - l2)*m2*c_psi*c_q1)*s_q2 + ((lcx2 + l2)*m2*c_psi*s_q1 + lcy2*m2*c_psi*c_q1)*c_q2 + (l1*m2 + (lcx1 + l1)*m1)*c_psi*s_q1 + lcy1*m1*c_psi*c_q1)*c_theta + ((-lcz2)*m2 - lcz1*m1)*s_phi*s_psi, (lcz2*m2 + lcz1*m1)*s_phi*c_psi*s_theta + (((lcx2 - l2)*m2*c_psi*s_q1 - lcy2*m2*c_psi*c_q1)*s_q2 + (lcy2*m2*c_psi*s_q1 + (lcx2 - l2)*m2*c_psi*c_q1)*c_q2 + lcy1*m1*c_psi*s_q1 + ((lcx1 - l1)*m1 - l1*m2)*c_psi*c_q1)*c_theta + ((-lcz2)*m2 - lcz1*m1)*c_phi*s_psi, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_psi*c_q1)*s_theta + (((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*s_q1 + (lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*c_q2 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*s_phi + lcy1*m1*c_phi)*s_psi*c_q1, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*c_q2)*s_theta + (((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*s_q1 + (lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*c_q2},
    {0., m2 + m1 + m, 0., ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*c_q1)*s_theta + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*s_q2 + ((lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*c_psi*s_q1 + ((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*c_q1)*c_q2 + (lcy1*m1*s_phi + ((lcx1 - l1)*m1 - l1*m2)*c_phi)*c_psi*s_q1 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*c_q1, ((-lcz2)*m2 - lcz1*m1)*c_phi*s_psi*s_theta + ((lcy2*m2*s_psi*s_q1 + (lcx2 - l2)*m2*s_psi*c_q1)*s_q2 + ((lcx2 + l2)*m2*s_psi*s_q1 + lcy2*m2*s_psi*c_q1)*c_q2 + (l1*m2 + (lcx1 + l1)*m1)*s_psi*s_q1 + lcy1*m1*s_psi*c_q1)*c_theta + (lcz2*m2 + lcz1*m1)*s_phi*c_psi, (lcz2*m2 + lcz1*m1)*s_phi*s_psi*s_theta + (((lcx2 - l2)*m2*s_psi*s_q1 - lcy2*m2*s_psi*c_q1)*s_q2 + (lcy2*m2*s_psi*s_q1 + (lcx2 - l2)*m2*s_psi*c_q1)*c_q2 + lcy1*m1*s_psi*s_q1 + ((lcx1 - l1)*m1 - l1*m2)*s_psi*c_q1)*c_theta + (lcz2*m2 + lcz1*m1)*c_phi*c_psi, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*c_q1)*s_theta + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*s_q2 + ((lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*c_psi*s_q1 + ((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*c_q1)*c_q2 + (lcy1*m1*s_phi + ((lcx1 - l1)*m1 - l1*m2)*c_phi)*c_psi*s_q1 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*c_q1, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*c_q1)*c_q2)*s_theta + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*s_q2 + ((lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*c_psi*s_q1 + ((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*c_q1)*c_q2},
    {0., 0., m2 + m1 + m, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_q1)*c_theta, (((lcx2 + l2)*m2*c_q1 - lcy2*m2*s_q1)*s_q2 + ((lcx2 - l2)*m2*s_q1 - lcy2*m2*c_q1)*c_q2 + ((lcx1 - l1)*m1 - l1*m2)*s_q1 - lcy1*m1*c_q1)*s_theta + ((-lcz2)*m2 - lcz1*m1)*c_phi*c_theta, (((lcx2 + l2)*m2*s_q1 + lcy2*m2*c_q1)*s_q2 + ((lcx2 + l2)*m2*c_q1 - lcy2*m2*s_q1)*c_q2 - lcy1*m1*s_q1 + (l1*m2 + (lcx1 + l1)*m1)*c_q1)*s_theta + (lcz2*m2 + lcz1*m1)*s_phi*c_theta, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_q1)*c_theta, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_q1)*c_q2)*c_theta},
    {((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_psi*c_q1)*s_theta + (((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*s_q1 + (lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*c_q2 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*s_phi + lcy1*m1*c_phi)*s_psi*c_q1, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*c_q1)*s_theta + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*s_q2 + ((lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*c_psi*s_q1 + ((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*c_q1)*c_q2 + (lcy1*m1*s_phi + ((lcx1 - l1)*m1 - l1*m2)*c_phi)*c_psi*s_q1 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*c_q1, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_q1)*c_theta, 2.*l1*lcy2*m2*s_q2 + (2.*l1*lcx2 + 2.*l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.) + pow(l1, 2.))*m2 + (pow(lcy1, 2.) + pow(lcx1, 2.) + 2.*l1*lcx1 + pow(l1, 2.))*m1 + Izz2 + Izz1 + Ix, (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*s_q2 + ((lcy2*lcz2*m2 - Iyz2)*s_q1 + ((lcx2 - l2)*lcz2*m2 + Ixz2)*c_q1)*c_q2 + (lcy1*lcz1*m1 - Iyz1)*s_q1 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*c_q1, ((Iyz2 - lcy2*lcz2*m2)*s_q1 + ((lcx2 + l2)*lcz2*m2 - Ixz2)*c_q1)*s_q2 + (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*c_q2 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*s_q1 + (Iyz1 - lcy1*lcz1*m1)*c_q1, 2.*l1*lcy2*m2*s_q2 + (2.*l1*lcx2 + 2.*l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.) + pow(l1, 2.))*m2 + (pow(lcy1, 2.) + pow(lcx1, 2.) + 2.*l1*lcx1 + pow(l1, 2.))*m1 + Izz2 + Izz1, l1*lcy2*m2*s_q2 + (l1*lcx2 + l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Izz2},
    {((-lcz2)*m2 - lcz1*m1)*c_phi*c_psi*s_theta + ((lcy2*m2*c_psi*s_q1 + (lcx2 - l2)*m2*c_psi*c_q1)*s_q2 + ((lcx2 + l2)*m2*c_psi*s_q1 + lcy2*m2*c_psi*c_q1)*c_q2 + (l1*m2 + (lcx1 + l1)*m1)*c_psi*s_q1 + lcy1*m1*c_psi*c_q1)*c_theta + ((-lcz2)*m2 - lcz1*m1)*s_phi*s_psi, ((-lcz2)*m2 - lcz1*m1)*c_phi*s_psi*s_theta + ((lcy2*m2*s_psi*s_q1 + (lcx2 - l2)*m2*s_psi*c_q1)*s_q2 + ((lcx2 + l2)*m2*s_psi*s_q1 + lcy2*m2*s_psi*c_q1)*c_q2 + (l1*m2 + (lcx1 + l1)*m1)*s_psi*s_q1 + lcy1*m1*s_psi*c_q1)*c_theta + (lcz2*m2 + lcz1*m1)*s_phi*c_psi, (((lcx2 + l2)*m2*c_q1 - lcy2*m2*s_q1)*s_q2 + ((lcx2 - l2)*m2*s_q1 - lcy2*m2*c_q1)*c_q2 + ((lcx1 - l1)*m1 - l1*m2)*s_q1 - lcy1*m1*c_q1)*s_theta + ((-lcz2)*m2 - lcz1*m1)*c_phi*c_theta, (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*s_q2 + ((lcy2*lcz2*m2 - Iyz2)*s_q1 + ((lcx2 - l2)*lcz2*m2 + Ixz2)*c_q1)*c_q2 + (lcy1*lcz1*m1 - Iyz1)*s_q1 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*c_q1, ((((2.*lcx2 + 2.*l2)*lcy2*m2 - 2.*Ixy2)*pow(s_q1, 2.) + ((2.*pow(lcy2, 2.) - 2.*pow(lcx2, 2.) - 4.*l2*lcx2 - 2.*pow(l2, 2.))*m2 - 2.*Iyy2 + 2.*Ixx2)*c_q1*s_q1 + (((-2.)*lcx2 - 2.*l2)*lcy2*m2 + 2.*Ixy2)*pow(c_q1, 2.))*c_q2 + 2.*l1*lcy2*m2*pow(s_q1, 2.) + ((-2.)*l1*lcx2 - 2.*l1*l2)*m2*c_q1*s_q1)*s_q2 + (((pow((-lcy2), 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Iyy2 - Ixx2)*pow(s_q1, 2.) + ((4.*lcx2 + 4.*l2)*lcy2*m2 - 4.*Ixy2)*c_q1*s_q1 + ((pow(lcy2, 2.) - pow(lcx2, 2.) - 2.*l2*lcx2 - pow(l2, 2.))*m2 - Iyy2 + Ixx2)*pow(c_q1, 2.))*pow(c_q2, 2.) + ((2.*l1*lcx2 + 2.*l1*l2)*m2*pow(s_q1, 2.) + 2.*l1*lcy2*m2*c_q1*s_q1)*c_q2 + ((pow(lcz2, 2.) + pow(lcy2, 2.) + pow(l1, 2.))*m2 + (pow(lcz1, 2.) + pow(lcx1, 2.) + 2.*l1*lcx1 + pow(l1, 2.))*m1 + Iyy1 + Ixx2)*pow(s_q1, 2.) + (((-2.)*lcx2 - 2.*l2)*lcy2*m2 + (2.*lcx1 + 2.*l1)*lcy1*m1 + 2.*Ixy2 - 2.*Ixy1)*c_q1*s_q1 + ((pow(lcz2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + (pow(lcz1, 2.) + pow(lcy1, 2.))*m1 + Iyy2 + Ixx1)*pow(c_q1, 2.) + Iy, ((((2.*pow(lcy2, 2.) - 2.*pow(lcx2, 2.) - 4.*l2*lcx2 - 2.*pow(l2, 2.))*m2 - 2.*Iyy2 + 2.*Ixx2)*pow(s_q1, 2.) + (((-4.)*lcx2 - 4.*l2)*lcy2*m2 + 4.*Ixy2)*c_q1*s_q1 + (pow((-lcy2), 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Iyy2 - Ixx2)*c_q2 + ((-2.)*l1*lcx2 - 2.*l1*l2)*m2*pow(s_q1, 2.) - 2.*l1*lcy2*m2*c_q1*s_q1 + (l1*lcx2 + l1*l2)*m2)*s_q2 + (((4.*lcx2 + 4.*l2)*lcy2*m2 - 4.*Ixy2)*pow(s_q1, 2.) + ((2.*pow(lcy2, 2.) - 2.*pow(lcx2, 2.) - 4.*l2*lcx2 - 2.*pow(l2, 2.))*m2 - 2.*Iyy2 + 2.*Ixx2)*c_q1*s_q1 + ((-2.)*lcx2 - 2.*l2)*lcy2*m2 + 2.*Ixy2)*pow(c_q2, 2.) + (2.*l1*lcy2*m2*pow(s_q1, 2.) + ((-2.)*l1*lcx2 - 2.*l1*l2)*m2*c_q1*s_q1 - l1*lcy2*m2)*c_q2 + (((-2.)*lcx2 - 2.*l2)*lcy2*m2 + (2.*lcx1 + 2.*l1)*lcy1*m1 + 2.*Ixy2 - 2.*Ixy1)*pow(s_q1, 2.) + ((pow((-lcy2), 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.) - pow(l1, 2.))*m2 + (pow(lcy1, 2.) - pow(lcx1, 2.) - 2.*l1*lcx1 - pow(l1, 2.))*m1 + Iyy2 - Iyy1 - Ixx2 + Ixx1)*c_q1*s_q1 + (lcx2 + l2)*lcy2*m2 + (lcx1 - l1)*lcy1*m1 - Ixy2 + Ixy1, (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*s_q2 + ((lcy2*lcz2*m2 - Iyz2)*s_q1 + ((lcx2 - l2)*lcz2*m2 + Ixz2)*c_q1)*c_q2 + (lcy1*lcz1*m1 - Iyz1)*s_q1 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*c_q1, (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*s_q2 + ((lcy2*lcz2*m2 - Iyz2)*s_q1 + ((lcx2 - l2)*lcz2*m2 + Ixz2)*c_q1)*c_q2},
    {(lcz2*m2 + lcz1*m1)*s_phi*c_psi*s_theta + (((lcx2 - l2)*m2*c_psi*s_q1 - lcy2*m2*c_psi*c_q1)*s_q2 + (lcy2*m2*c_psi*s_q1 + (lcx2 - l2)*m2*c_psi*c_q1)*c_q2 + lcy1*m1*c_psi*s_q1 + ((lcx1 - l1)*m1 - l1*m2)*c_psi*c_q1)*c_theta + ((-lcz2)*m2 - lcz1*m1)*c_phi*s_psi, (lcz2*m2 + lcz1*m1)*s_phi*s_psi*s_theta + (((lcx2 - l2)*m2*s_psi*s_q1 - lcy2*m2*s_psi*c_q1)*s_q2 + (lcy2*m2*s_psi*s_q1 + (lcx2 - l2)*m2*s_psi*c_q1)*c_q2 + lcy1*m1*s_psi*s_q1 + ((lcx1 - l1)*m1 - l1*m2)*s_psi*c_q1)*c_theta + (lcz2*m2 + lcz1*m1)*c_phi*c_psi, (((lcx2 + l2)*m2*s_q1 + lcy2*m2*c_q1)*s_q2 + ((lcx2 + l2)*m2*c_q1 - lcy2*m2*s_q1)*c_q2 - lcy1*m1*s_q1 + (l1*m2 + (lcx1 + l1)*m1)*c_q1)*s_theta + (lcz2*m2 + lcz1*m1)*s_phi*c_theta, ((Iyz2 - lcy2*lcz2*m2)*s_q1 + ((lcx2 + l2)*lcz2*m2 - Ixz2)*c_q1)*s_q2 + (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*c_q2 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*s_q1 + (Iyz1 - lcy1*lcz1*m1)*c_q1, ((((2.*pow(lcy2, 2.) - 2.*pow(lcx2, 2.) - 4.*l2*lcx2 - 2.*pow(l2, 2.))*m2 - 2.*Iyy2 + 2.*Ixx2)*pow(s_q1, 2.) + (((-4.)*lcx2 - 4.*l2)*lcy2*m2 + 4.*Ixy2)*c_q1*s_q1 + (pow((-lcy2), 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Iyy2 - Ixx2)*c_q2 + ((-2.)*l1*lcx2 - 2.*l1*l2)*m2*pow(s_q1, 2.) - 2.*l1*lcy2*m2*c_q1*s_q1 + (l1*lcx2 + l1*l2)*m2)*s_q2 + (((4.*lcx2 + 4.*l2)*lcy2*m2 - 4.*Ixy2)*pow(s_q1, 2.) + ((2.*pow(lcy2, 2.) - 2.*pow(lcx2, 2.) - 4.*l2*lcx2 - 2.*pow(l2, 2.))*m2 - 2.*Iyy2 + 2.*Ixx2)*c_q1*s_q1 + ((-2.)*lcx2 - 2.*l2)*lcy2*m2 + 2.*Ixy2)*pow(c_q2, 2.) + (2.*l1*lcy2*m2*pow(s_q1, 2.) + ((-2.)*l1*lcx2 - 2.*l1*l2)*m2*c_q1*s_q1 - l1*lcy2*m2)*c_q2 + (((-2.)*lcx2 - 2.*l2)*lcy2*m2 + (2.*lcx1 + 2.*l1)*lcy1*m1 + 2.*Ixy2 - 2.*Ixy1)*pow(s_q1, 2.) + ((pow((-lcy2), 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.) - pow(l1, 2.))*m2 + (pow(lcy1, 2.) - pow(lcx1, 2.) - 2.*l1*lcx1 - pow(l1, 2.))*m1 + Iyy2 - Iyy1 - Ixx2 + Ixx1)*c_q1*s_q1 + (lcx2 + l2)*lcy2*m2 + (lcx1 - l1)*lcy1*m1 - Ixy2 + Ixy1, (((((-2.)*lcx2 - 2.*l2)*lcy2*m2 + 2.*Ixy2)*pow(s_q1, 2.) + (((-2.)*pow(lcy2, 2.) + 2.*pow(lcx2, 2.) + 4.*l2*lcx2 + 2.*pow(l2, 2.))*m2 + 2.*Iyy2 - 2.*Ixx2)*c_q1*s_q1 + ((2.*lcx2 + 2.*l2)*lcy2*m2 - 2.*Ixy2)*pow(c_q1, 2.))*c_q2 + (2.*l1*lcx2 + 2.*l1*l2)*m2*c_q1*s_q1 + 2.*l1*lcy2*m2*pow(c_q1, 2.))*s_q2 + (((pow(lcy2, 2.) - pow(lcx2, 2.) - 2.*l2*lcx2 - pow(l2, 2.))*m2 - Iyy2 + Ixx2)*pow(s_q1, 2.) + (((-4.)*lcx2 - 4.*l2)*lcy2*m2 + 4.*Ixy2)*c_q1*s_q1 + ((pow((-lcy2), 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Iyy2 - Ixx2)*pow(c_q1, 2.))*pow(c_q2, 2.) + ((2.*l1*lcx2 + 2.*l1*l2)*m2*pow(c_q1, 2.) - 2.*l1*lcy2*m2*c_q1*s_q1)*c_q2 + ((pow(lcz2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + (pow(lcz1, 2.) + pow(lcy1, 2.))*m1 + Iyy2 + Ixx1)*pow(s_q1, 2.) + ((2.*lcx2 + 2.*l2)*lcy2*m2 + ((-2.)*lcx1 - 2.*l1)*lcy1*m1 - 2.*Ixy2 + 2.*Ixy1)*c_q1*s_q1 + ((pow(lcz2, 2.) + pow(lcy2, 2.) + pow(l1, 2.))*m2 + (pow(lcz1, 2.) + pow(lcx1, 2.) + 2.*l1*lcx1 + pow(l1, 2.))*m1 + Iyy1 + Ixx2)*pow(c_q1, 2.) + Iz, ((Iyz2 - lcy2*lcz2*m2)*s_q1 + ((lcx2 + l2)*lcz2*m2 - Ixz2)*c_q1)*s_q2 + (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*c_q2 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*s_q1 + (Iyz1 - lcy1*lcz1*m1)*c_q1, ((Iyz2 - lcy2*lcz2*m2)*s_q1 + ((lcx2 + l2)*lcz2*m2 - Ixz2)*c_q1)*s_q2 + (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*c_q2},
    {((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_psi*c_q1)*s_theta + (((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*s_q1 + (lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*c_q2 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*s_phi + lcy1*m1*c_phi)*s_psi*c_q1, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_psi*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*s_psi*c_q1)*s_theta + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*s_q2 + ((lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*c_psi*s_q1 + ((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*c_q1)*c_q2 + (lcy1*m1*s_phi + ((lcx1 - l1)*m1 - l1*m2)*c_phi)*c_psi*s_q1 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*c_psi*c_q1, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_q1)*c_q2 + (((lcx1 - l1)*m1 - l1*m2)*s_phi - lcy1*m1*c_phi)*s_q1 + ((l1*m2 + (lcx1 + l1)*m1)*c_phi - lcy1*m1*s_phi)*c_q1)*c_theta, 2.*l1*lcy2*m2*s_q2 + (2.*l1*lcx2 + 2.*l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.) + pow(l1, 2.))*m2 + (pow(lcy1, 2.) + pow(lcx1, 2.) + 2.*l1*lcx1 + pow(l1, 2.))*m1 + Izz2 + Izz1, (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*s_q2 + ((lcy2*lcz2*m2 - Iyz2)*s_q1 + ((lcx2 - l2)*lcz2*m2 + Ixz2)*c_q1)*c_q2 + (lcy1*lcz1*m1 - Iyz1)*s_q1 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*c_q1, ((Iyz2 - lcy2*lcz2*m2)*s_q1 + ((lcx2 + l2)*lcz2*m2 - Ixz2)*c_q1)*s_q2 + (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*c_q2 + ((-l1)*lcz2*m2 + (lcx1 - l1)*lcz1*m1 + Ixz1)*s_q1 + (Iyz1 - lcy1*lcz1*m1)*c_q1, 2.*l1*lcy2*m2*s_q2 + (2.*l1*lcx2 + 2.*l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.) + pow(l1, 2.))*m2 + (pow(lcy1, 2.) + pow(lcx1, 2.) + 2.*l1*lcx1 + pow(l1, 2.))*m1 + Izz2 + Izz1, l1*lcy2*m2*s_q2 + (l1*lcx2 + l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Izz2},
    {((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*c_q2)*s_theta + (((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*s_q1 + (lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*c_q2, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*s_psi*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_psi*c_q1)*c_q2)*s_theta + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_psi*c_q1)*s_q2 + ((lcy2*m2*s_phi + (lcx2 - l2)*m2*c_phi)*c_psi*s_q1 + ((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*c_psi*c_q1)*c_q2, ((((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*s_q1 + ((lcx2 + l2)*m2*s_phi + lcy2*m2*c_phi)*c_q1)*s_q2 + (((lcx2 - l2)*m2*s_phi - lcy2*m2*c_phi)*s_q1 + ((lcx2 + l2)*m2*c_phi - lcy2*m2*s_phi)*c_q1)*c_q2)*c_theta, l1*lcy2*m2*s_q2 + (l1*lcx2 + l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Izz2, (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*s_q2 + ((lcy2*lcz2*m2 - Iyz2)*s_q1 + ((lcx2 - l2)*lcz2*m2 + Ixz2)*c_q1)*c_q2, ((Iyz2 - lcy2*lcz2*m2)*s_q1 + ((lcx2 + l2)*lcz2*m2 - Ixz2)*c_q1)*s_q2 + (((lcx2 - l2)*lcz2*m2 + Ixz2)*s_q1 + (Iyz2 - lcy2*lcz2*m2)*c_q1)*c_q2, l1*lcy2*m2*s_q2 + (l1*lcx2 + l1*l2)*m2*c_q2 + (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Izz2, (pow(lcy2, 2.) + pow(lcx2, 2.) + 2.*l2*lcx2 + pow(l2, 2.))*m2 + Izz2}
};
    double W[8][1] = {
    {(c_phi*c_psi*s_theta + s_phi*s_psi)*U1 - (s_phi*c_psi*s_theta - c_phi*s_psi)*(c_q1*(m2*c_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*s_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta)) - s_q1*((-m2)*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta))) - (c_phi*c_psi*s_theta + s_phi*s_psi)*(c_q1*((-m2)*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta)) + s_q1*(m2*c_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*s_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta))) - c_psi*c_theta*(m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta))},
    {(c_phi*s_psi*s_theta - s_phi*c_psi)*U1 - (s_phi*s_psi*s_theta + c_phi*c_psi)*(c_q1*(m2*c_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*s_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta)) - s_q1*((-m2)*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta))) - (c_phi*s_psi*s_theta - s_phi*c_psi)*(c_q1*((-m2)*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta)) + s_q1*(m2*c_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*s_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta))) - s_psi*c_theta*(m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta))},
    {c_phi*c_theta*U1 - s_phi*c_theta*(c_q1*(m2*c_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*s_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta)) - s_q1*((-m2)*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta))) - c_phi*c_theta*(c_q1*((-m2)*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta)) + s_q1*(m2*c_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + m2*s_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta))) + s_theta*(m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta)) - g*m},
    {la*U2 + l1*m2*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + lcy2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - l1*m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (lcx2 + l2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + lcy1*m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - Ixz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - Iyz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1)) - (lcx1 + l1)*m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - (s_q1*wz + c_q1*wy)*(Ixy1*(s_q1*wz + c_q1*wy) + Iyy1*(c_q1*wz - s_q1*wy) + Iyz1*(wx + qd1)) + (c_q1*wz - s_q1*wy)*(Ixx1*(s_q1*wz + c_q1*wy) + Ixy1*(c_q1*wz - s_q1*wy) + Ixz1*(wx + qd1)) - Iyz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - Ixz1*(c_q1*qd1*wz - s_q1*qd1*wy) + (Iy - Iz)*wy*wz},
    {la*U3 - c_q1*(s_q2*(lcz2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - l1*m2*c_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - (lcx2 + l2)*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Iyy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) + (wx + qd2 + qd1)*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1))) + c_q2*((-lcz2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + l1*m2*s_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + lcy2*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixx2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Ixy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) - (wx + qd2 + qd1)*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1))) + lcy1*m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - lcz1*m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + (c_q1*wz - s_q1*wy)*(Ixz1*(s_q1*wz + c_q1*wy) + Iyz1*(c_q1*wz - s_q1*wy) + Izz1*(wx + qd1)) - (wx + qd1)*(Ixy1*(s_q1*wz + c_q1*wy) + Iyy1*(c_q1*wz - s_q1*wy) + Iyz1*(wx + qd1)) + Ixy1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + Ixx1*(c_q1*qd1*wz - s_q1*qd1*wy)) + s_q1*(c_q2*(lcz2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - l1*m2*c_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - (lcx2 + l2)*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Iyy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) + (wx + qd2 + qd1)*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1))) - s_q2*((-lcz2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + l1*m2*s_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + lcy2*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixx2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Ixy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) - (wx + qd2 + qd1)*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1))) + lcz1*m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - (lcx1 + l1)*m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - (s_q1*wz + c_q1*wy)*(Ixz1*(s_q1*wz + c_q1*wy) + Iyz1*(c_q1*wz - s_q1*wy) + Izz1*(wx + qd1)) + (wx + qd1)*(Ixx1*(s_q1*wz + c_q1*wy) + Ixy1*(c_q1*wz - s_q1*wy) + Ixz1*(wx + qd1)) + Iyy1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + Ixy1*(c_q1*qd1*wz - s_q1*qd1*wy)) + (Iz - Ix)*wx*wz},
    {U4 - s_q1*(s_q2*(lcz2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - l1*m2*c_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - (lcx2 + l2)*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Iyy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) + (wx + qd2 + qd1)*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1))) + c_q2*((-lcz2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + l1*m2*s_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + lcy2*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixx2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Ixy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) - (wx + qd2 + qd1)*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1))) + lcy1*m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - lcz1*m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + (c_q1*wz - s_q1*wy)*(Ixz1*(s_q1*wz + c_q1*wy) + Iyz1*(c_q1*wz - s_q1*wy) + Izz1*(wx + qd1)) - (wx + qd1)*(Ixy1*(s_q1*wz + c_q1*wy) + Iyy1*(c_q1*wz - s_q1*wy) + Iyz1*(wx + qd1)) + Ixy1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + Ixx1*(c_q1*qd1*wz - s_q1*qd1*wy)) - c_q1*(c_q2*(lcz2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - l1*m2*c_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - (lcx2 + l2)*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Iyy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) + (wx + qd2 + qd1)*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1))) - s_q2*((-lcz2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + l1*m2*s_q2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + lcy2*m2*(lcy2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - lcx2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - l2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) + (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) + l2*(wx + qd2 + qd1)*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) + Ixx2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + Ixy2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Iyz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Izz2*(wx + qd2 + qd1)) - (wx + qd2 + qd1)*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1))) + lcz1*m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - (lcx1 + l1)*m1*((s_q1*wz + c_q1*wy)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) - (c_q1*wz - s_q1*wy)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcx1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + lcy1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(wx + qd1)*(s_q1*wz + c_q1*wy) - g*s_theta) - (s_q1*wz + c_q1*wy)*(Ixz1*(s_q1*wz + c_q1*wy) + Iyz1*(c_q1*wz - s_q1*wy) + Izz1*(wx + qd1)) + (wx + qd1)*(Ixx1*(s_q1*wz + c_q1*wy) + Ixy1*(c_q1*wz - s_q1*wy) + Ixz1*(wx + qd1)) + Iyy1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) + Ixy1*(c_q1*qd1*wz - s_q1*qd1*wy)) + (Ix - Iy)*wx*wy},
    {l1*m2*s_q2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) + lcy2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - l1*m2*c_q2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (lcx2 + l2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + lcy1*m1*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - (wx + qd1)*(lcx1*(wx + qd1) - lcz1*(s_q1*wz + c_q1*wy)) + (c_q1*wz - s_q1*wy)*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + lcz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - Ixz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - Iyz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1)) - (lcx1 + l1)*m1*(((-(s_q1*wz + c_q1*wy)))*(lcy1*(s_q1*wz + c_q1*wy) - lcx1*(c_q1*wz - s_q1*wy)) + (wx + qd1)*(lcz1*(c_q1*wz - s_q1*wy) - lcy1*(wx + qd1)) - lcz1*(c_q1*qd1*wz - s_q1*qd1*wy) + l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - (s_q1*wz + c_q1*wy)*(Ixy1*(s_q1*wz + c_q1*wy) + Iyy1*(c_q1*wz - s_q1*wy) + Iyz1*(wx + qd1)) + (c_q1*wz - s_q1*wy)*(Ixx1*(s_q1*wz + c_q1*wy) + Ixy1*(c_q1*wz - s_q1*wy) + Ixz1*(wx + qd1)) - Iyz1*((-sin(q1))*qd1*wz - c_q1*qd1*wy) - Ixz1*(c_q1*qd1*wz - s_q1*qd1*wy) + tau1},
    {lcy2*m2*((-l2)*pow(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy), 2.) + c_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) + lcz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - (wx + qd2 + qd1)*(lcx2*(wx + qd2 + qd1) - lcz2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))) - s_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) - l2*pow(wx + qd2 + qd1, 2.)) - (lcx2 + l2)*m2*(s_q2*((-l1)*pow(c_q1*wz - s_q1*wy, 2.) - l1*pow(wx + qd1, 2.) + g*c_phi*s_q1*c_theta + g*s_phi*c_q1*c_theta) - lcz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) + (wx + qd2 + qd1)*(lcz2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) - lcy2*(wx + qd2 + qd1)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(lcy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) - lcx2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) + c_q2*(l1*(c_q1*wz - s_q1*wy)*(s_q1*wz + c_q1*wy) - g*s_phi*s_q1*c_theta + g*c_phi*c_q1*c_theta) + l2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))) - Ixz2*(c_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy) - s_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy)) - Iyz2*(c_q2*((-qd2)*(s_q1*wz + c_q1*wy) - s_q1*qd1*wz - c_q1*qd1*wy) + s_q2*(qd2*(c_q1*wz - s_q1*wy) + c_q1*qd1*wz - s_q1*qd1*wy)) - (c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy))*(Iyy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixy2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Iyz2*(wx + qd2 + qd1)) + (s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy))*(Ixy2*(s_q2*(s_q1*wz + c_q1*wy) + c_q2*(c_q1*wz - s_q1*wy)) + Ixx2*(c_q2*(s_q1*wz + c_q1*wy) - s_q2*(c_q1*wz - s_q1*wy)) + Ixz2*(wx + qd2 + qd1)) + tau2}
};

    mxSystemSolve((CTFloat *)D, (CTFloat *)W, 8);

    dX[0] = X[1];
    dX[1] = W[0][0];
    dX[2] = X[3];
    dX[3] = W[1][0];
    dX[4] = X[5];
    dX[5] = W[2][0];
    dX[6] = X[7];
    dX[7] = W[3][0];
    dX[8] = X[9];
    dX[9] = W[4][0];
    dX[10] = X[11];
    dX[11] = W[5][0];
    dX[12] = X[13];
    dX[13] = W[6][0];
    dX[14] = X[15];
    dX[15] = W[7][0];

}
